local starter = require 'mini.starter'
-- [é£æ ¼ 1] ç»å…¸çš„ Slant é£æ ¼ (é»˜è®¤)
-- local my_ascii = {
--   '   _  __     __      _ __    ',
--   '  / |/ /__  / /_____(_) /_ __',
--   " /    / -_)/ // / -_) / / '  \\",
--   '/_/|_/\\__//_/ \\__/_/_/_/_/_/_/',
-- }
--
-- [é£æ ¼ 2] 3D Block é£æ ¼
local my_ascii = {
  'â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—',
  'â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘',
  'â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘',
  'â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘',
  'â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘',
  'â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•   â•šâ•â•â•â•  â•šâ•â•â•šâ•â•     â•šâ•â•',
}
-- local my_ascii =
--  [[
-- â¢€â£´â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â¡€â €â ‰â£½â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿
-- â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡„â €â »â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡Ÿâ »â£¿â£¿â£¿â£¿â£¿â£¿â Ÿâ ‰â¢»
-- â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢›â¡Ÿâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡„â €â ˜â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â €â €â ˆâ »â ¿â ¿â ¿â â €â €â €
-- â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£â£´â¢¹â£¿â¡œâ£¿â£¿â£¿â£¿â£¿â£¿â¡½â£¿â£¿â¡„â €â¢ˆâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‡â €â¢€â£¤â£¶â£¿â£¿â£¿â£¿â£¶â£€â €
-- â£¿â£¿â£¿â£¿â£¿â£¿â£â¢›â£¿â£¿â£¿â£¿â¡Ÿâ£¿â£¿â£¿â£¿â ¿â£Ÿâ¢¿â£¿â£¿â£¿â£¿â£§â¢¿â£¿â£·â €â£ â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‡â£°â£¾â¢Ÿâ¢»â£¿â£¿â£¿â£¿â£¿â£¿â¡†
-- â¢¹â£¿â£¿â£¿â£¿â£¿â¢‹â£¿â£¿â£¿â£¿â£¿â£§â¢»â Ÿâ¢â¡”â €â °â †â¢™â¢»â£¿â£¿â£¿â£¸â£¿â£¿â¢ â£¿â£¸â£¿â£¿â£¿â£¿â£¿â£¿â¢³â£¿â£Ÿâ£¾â¡¼â ¹â£¿â£Œâ¢«â£¿â£¿â£¿
-- â£¿â£¿â£¿â£¿â£¿â ›â¡«â ‰â£‰â¢™â£¶â£¿â£¾â£¿â£¿â£¿â£â €â €â €â£¸â£¿â£¿â¢¸â£¿â£¿â£¿â£¿â¢¸â£¿â¡â£¿â£¿â£¿â£¿â£¿â£¿â¡¾â¡›â£¨â ‰â¢±â£¿â£¾â£¿â ‰â ˜â£»â£¿
-- â£¿â£¿â¢Ÿâ£¯â¡…â£¾â¡â €â €â €â£¿â£¿â£¿â£¿â£¿â£¿â£·â£¶â£¶â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‡â£¶â£¿â£¿â£¿â£¿â£¿â£¿â¡‡â£§â¢¿â£¶â£¾â£¿â£¿â£¿â£¶â£¶â¢¿â£¿
-- â£¿â£¿â£â¢¿â£¿â£¿â£·â£¤â£ â£¼â£¿â£¿â£¿â ¿â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£Ÿâ£¿â£¿â£¿â¡Ÿâ ©â ¾â §â ¿â¢¿â£¿â£¿â£¿â£¿â£¿â£§â ¿â¢œâ »â¢¿â£¿â£‰â£¿â¡¿â¢Ÿâ¡Šâ ‰
-- â£¿â£¿â£¿â£â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢€â£´â£¶â£¬â£™â¢¿â£¿â£¿â¡Ÿâ ™â Ÿâ ‹â â €â €â¢€â£ â£¤â£„â €â ˆâ ™â »â£¿â£¿â£¿â¡â¢€â €â¢²â£œâ¢›â¢¨â¡â ¿â »
-- â£¿â£¿â¡¿â ¿â â ›â ¿â ¿â£¿â£¿â£¿â£¿â£¿â£´â£½â£¿â£¿â£¿â¡â£›â£½â¡‡â €â €â €â €â €â¢ â£¿â£¿â£¿â£¿â£·â£„â €â €â ˆâ »â£¿â¡¿â €â ‘â¢¿â †â¢€â£¾â¡€â €â €
-- â£™â¡¿â ‡â €â €â €â¢ â£„â£€â ¸â¡–â¢ â£¿â£­â£¿â£¿â£¿â£¿â Ÿâ£‡â¡Ÿâ €â €â €â €â €â €â¢¸â£¿â£¿â£¿â£¿â£¿â£¿â£¦â €â €â €â ™â ƒâ €â ¾â ‡â €â¢¸â£…â €â €â¢€
-- â£½â£¤â£¶â£¶â£„â €â¢¸â£¿â£¿â ‚â €â ¸â£¿â£¿â¡¼â¡¿â ‚â €â£›â¡â €â €â €â €â¢€â£¤â£¶â£¾â¢¿â£»â£¿â£¿â£¿â£¿â£¿â£‡â €â €â €â¢·â£¶â£†â£€â¡€â °â£¦â£²â£¾â£®
-- â£¿â£¿â£¿â£¿â£¿â¡€â €â €â €â¢€â£´â£¿â£·â£¾â£­â£¾â¢„â €â »â â €â €â €â ¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡Ÿâ €â €â €â¢¸â£¯â£½â£¿â£·â¡€â¢¹â£¯â¢·â£¬
-- ]]
-- [é£æ ¼ 3] æç®€å° Logo
-- local my_ascii = {
--   "      î‚ºâ–ˆâ–ˆâ–ˆî‚¸       ",
--   "      î‚ºâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆî‚¸      ",
--   "     î‚ºâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆî‚¸     ",
--   "    î‚ºâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆî‚¸    ",
--   "   î‚ºâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆî‚¸   ",
--   "  î‚ºâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆî‚¸  ",
-- }

local function get_header()
  -- é¡¶éƒ¨ Logo
  local logo = table.concat(my_ascii, '\n')

  -- è£…é¥°æ€§çš„æ¨ªå‘èœå• (è§†è§‰ä¸Šæ¨¡æ‹Ÿ Dashboardï¼Œå®é™…æŒ‰é”®åœ¨ items é‡Œå®šä¹‰)
  -- è¿™é‡Œçš„ u, f, a, q å¯¹åº”ä¸‹é¢ items çš„å¿«æ·é”®
  local menu = 'ğŸ”„ Update[u]   ğŸ“‚ Files[f]   âŒ Quit[q]'

  -- ç»„åˆ: Logo + ç©ºè¡Œ + èœå•
  return logo .. '\n\n' .. menu
end

starter.setup {
  -- è®¾ç½®å¤´éƒ¨
  header = get_header,

  -- è®¾ç½®èœå•é¡¹
  items = {
    -- 1. å¸¸ç”¨åŠ¨ä½œ (å¯¹åº” Header é‡Œçš„è£…é¥°èœå•)
    { name = 'Update Plugins', action = 'Lazy sync', section = 'Actions' },
    { name = 'Find Files', action = 'Pick files', section = 'Actions' },
    { name = 'Quit Neovim', action = 'qa', section = 'Actions' },

    -- 2. æœ€è¿‘çš„é¡¹ç›® (ä¾èµ– mini.sessions)
    starter.sections.sessions(5, true),

    -- 3. æœ€è¿‘çš„æ–‡ä»¶
    starter.sections.recent_files(5, false),
  },

  -- å†…å®¹ä¿®é¥° (å±…ä¸­ã€å›¾æ ‡)
  content_hooks = {
    -- ç»™æ¯ä¸€é¡¹åŠ ä¸ªå›¾æ ‡ç©ºä½ï¼Œæˆ–è€…ä½ å¯ä»¥å®‰è£… nvim-web-devicons æ¥æ˜¾ç¤ºçœŸå®å›¾æ ‡
    starter.gen_hook.adding_bullet 'Â» ',

    -- å…¨éƒ¨å±…ä¸­
    starter.gen_hook.aligning('center', 'center'),

    -- è‡ªåŠ¨ç”Ÿæˆå¿«æ·é”®
    -- è¿™é‡Œçš„é¡ºåºå†³å®šäº†å¿«æ·é”®ï¼šActions é‡Œçš„å‰å‡ é¡¹ä¼šè‡ªåŠ¨å˜æˆ u, f, a, q (å¦‚æœé¦–å­—æ¯åŒ¹é…çš„è¯)
    starter.gen_hook.indexing('all', { 'Actions', 'Sessions', 'Recent files' }),
  },

  -- åº•éƒ¨æ˜¾ç¤ºçš„åŠ è½½ç»Ÿè®¡
  footer = '',

  evaluate_single = true,
}

vim.api.nvim_create_autocmd('VimEnter', {
  callback = function()
    -- ä½¿ç”¨ vim.schedule ç¡®ä¿åœ¨ UI ç»˜åˆ¶å®Œæˆåå†æ‰§è¡Œåˆ·æ–°
    vim.schedule(function()
      local stats = require('lazy').stats()
      local ms = stats.startuptime

      -- æˆ‘ä»¬çš„è€æœ‹å‹ï¼šé˜²æ­¢ 0ms çš„è¡¥ç®—é€»è¾‘
      if not ms or ms == 0 then
        -- å…¼å®¹æ€§å†™æ³•ï¼šæ–°ç‰ˆç”¨ vim.uvï¼Œæ—§ç‰ˆç”¨ vim.loop
        local uv = vim.uv or vim.loop
        local now = uv.hrtime()
        ms = (now - stats.start_time) / 1e6
      end

      local pad_footer = string.rep(' ', 8)
      local footer_text = pad_footer .. 'âš¡ Neovim loaded ' .. stats.count .. ' plugins in ' .. string.format('%.1f', ms) .. ' ms'

      -- åŠ¨æ€ä¿®æ”¹é…ç½®
      starter.config.footer = footer_text

      -- å¦‚æœå½“å‰åœç•™åœ¨ Dashboardï¼Œå¼ºåˆ¶åˆ·æ–°
      if vim.bo.filetype == 'ministarter' then
        pcall(starter.refresh)
      end
    end)
  end,
})

-- indent
vim.api.nvim_create_autocmd('User', {
  pattern = 'MiniStarterOpened',
  callback = function()
    -- å¼ºåˆ¶ç¦ç”¨å½“å‰ buffer (Starter buffer) çš„ indentscope
    vim.b.miniindentscope_disable = true

    -- å¦‚æœä½ åŒæ—¶ä¹Ÿè£…äº† indent-blankline (ibl)ï¼Œä¹Ÿå»ºè®®é¡ºæ‰‹å…³æ‰ï¼Œä»¥é˜²ä¸‡ä¸€
    vim.b.ibl_enabled = false
  end,
})

vim.cmd [[
  " Logo é¢œè‰² - æ©™çº¢è‰²
  highlight MiniStarterHeader guifg=#ff7e67 gui=bold
  
  " åº•éƒ¨ç»Ÿè®¡é¢œè‰² - ç°è‰²
  highlight MiniStarterFooter guifg=#5c6370 gui=italic

  " åˆ†ç±»æ ‡é¢˜ (Actions/Sessions) - è“è‰²
  highlight MiniStarterSection guifg=#61afef gui=bold
  
  " åˆ—è¡¨é¡¹ - ç™½è‰²
  highlight MiniStarterItem guifg=#abb2bf
  
  " å¿«æ·é”®æç¤º - çº¢è‰²
  highlight MiniStarterQuery guifg=#e06c75
  
  " é€‰ä¸­é¡¹èƒŒæ™¯ - æ·±ç°
  highlight MiniStarterItemPrefix guifg=#98c379
]]
